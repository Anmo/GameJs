!function(){"use strict";var t,n=0,i=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(i){var e=Math.max(0,16-((t=(new Date).getTime())-n)),s=setTimeout(function(){i(t+e)},e);return n=t+e,s},e=window.cancelAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||function(t){clearTimeout(t)},s=function(){return this.init()};s.prototype={init:function(){this._objects=[],this._triggers={};var t=this;return"ontouchstart"in window?(this._start="touchstart",this._end="touchend"):(this._start="mousedown",this._end="mouseup"),window.addEventListener("keydown",function(n){for(var i=t._triggers[n.keyCode]||[],e=0,s=i.length;s>e;e++){var a=i[e],r=a[0],o=a[1],u=o.ms;(o=r._actions[o.start]).status||t._raf(r,o,u)}}),window.addEventListener("keyup",function(n){for(var i=t._triggers[n.keyCode]||[],s=0,a=i.length;a>s;s++){var r=i[s],o=r[0],u=r[1],c=u.ms,m=o._actions[u.start];e(m.status),delete m.status,(u=o._actions[u.end]).status||t._raf(o,u,c)}}),this},_raf:function(t,n,e){var s,a=this,r=function(o){s||(s=o);var u=!0,c=o-s;c>=e&&(s=0,u=n.cb.call(t,a)),u?n.status=i(r):delete n.status};n.status=i(r)},trigger:function(t,n){var i=this,s=n.trigger,a=t._actions[n.start],r=t._actions[n.end],o=n.ms;s&&(s.addEventListener(this._start,function(n){a.status||i._raf(t,a,o),n.preventDefault()}),s.addEventListener(this._end,function(n){e(a.status),delete a.status,r.status||i._raf(t,r,o),n.preventDefault()}))},createObject:function(){return this._Object.apply(this,[this].concat(arguments))}};var a=s.prototype._Object=function(t){return this instanceof a?((this._game=t)._objects.push(this),this.init()):new this._Object(t)};a.prototype={init:function(){return this._actions={},this},action:function(t,n){return this._actions[t]={cb:n},this},trigger:function(t){return"start"in t&&!(t.start in this._actions)||"end"in t&&!(t.end in this._actions)?this:"number"==typeof t.trigger&&"trigger"in t?((this._game._triggers[t.trigger]=this._game._triggers[t.trigger]||[]).push([this,t]),this):(this._game.trigger(this,t),this)}},"function"==typeof define&&define.amd?define("GameJs",s):window.GameJs=s}();